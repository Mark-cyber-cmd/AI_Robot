import scipy.signal as signal
import numpy as np
import matplotlib.pyplot as plt

b, a = signal.iirdesign(np.pi/1248, np.pi/1248*1.5, 1, 40)
print(b, a)
w, h = signal.freqz(b, a)
Abs_h = 20*np.log10(np.clip(np.abs(h), 1e-8, 1e100))
Angle_h = np.angle(h)
plt.figure(1)
plt.subplot(2, 1, 1)
plt.plot(w/np.pi*1248, Abs_h)
plt.xlim(0, 20)
plt.subplot(2, 1, 2)
plt.plot(w/np.pi*1248, Angle_h)
plt.xlim(0, 20)
plt.show()
t = np.arange(0, 2, 1/8000.0)
sweep = signal.chirp(t, f0=0, t1=2, f1=100.0)
out = signal.lfilter(b, a, sweep)
plt.figure(2)
plt.subplot(2, 1, 1)
plt.plot(t, sweep)
plt.subplot(2, 1, 2)
plt.plot(t, out)
plt.show()
